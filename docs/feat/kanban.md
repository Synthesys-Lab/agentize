# Kanban Viewboard Management

## Overview

This document describes how Agentize integrates with GitHub Projects V2 to provide kanban-style viewboard management.

- Each plan created by `core/ultra-planner.md` will be represented as an entry on the viewboard.
- Each PR executed from plans by `core/issue-to-impl.md` will be represented as an entry on the viewboard.

The "viewboard" is a GitHub Projects v2 board with multiple views (typically a Board view for issues and a Table/Board view for PRs). Agentize relies on the **default Status field** so that drag-and-drop in Board view updates lifecycle state automatically.

## Setup

**Recommended:** use `/setup-viewboard` to create/associate a Project v2 board, configure Status options, and create labels.

```
/setup-viewboard [--org <org-name>]
```

This workflow:
- Creates or associates a Project v2 board and stores it in `.agentize.yaml`
- Ensures Status options exist (Proposed, Refining, Rebasing, Plan Accepted, In Progress, Done)
- Creates agentize labels used for discovery and automation

See:
- [Setup Viewboard](../commands/setup-viewboard.md)
- [Project Management](../architecture/project.md)

## View Structure

Use a **single Project v2** with multiple filtered views:

### Plans View (Issues)

Recommended filter:
```
is:issue is:open label:agentize:plan
```

This view is your plan backlog and approval queue.

### Implementations View (PRs)

Recommended filter:
```
is:pr is:open label:agentize:pr
```

This view tracks active implementations and reviews.

You can create additional views (e.g., "Refining", "Rebasing") by filtering on the Status field.

## Status Lifecycle

Agentize uses the default Project Status field to drive the kanban columns:

| Status | Meaning | Typical Trigger |
|--------|---------|-----------------|
| Proposed | New plan created, awaiting review | `/ultra-planner`, auto-add workflow |
| Refining | Plan refinement in progress | `lol serve` + `/ultra-planner --refine` |
| Rebasing | PR branch being rebased | `lol serve` + `wt rebase` |
| Plan Accepted | Approved for implementation | Manual review gate |
| In Progress | Worktree created and implementation started | `wt spawn` (best-effort) |
| Done | Completed and merged/closed | GitHub auto-archive or manual close |

**Key rules:**
- **Plan Accepted is the approval gate** for implementation. `lol serve` only spawns work when Status = "Plan Accepted".
- **Refining** is optional but required if you enable auto-refinement.
- **Rebasing** is used for visibility when the server resolves conflicts.

For more detail, see [Project Management](../architecture/project.md).

## Automation & Sync

There are two ways to keep issues/PRs synced to the viewboard:

1. **GitHub built-in auto-add workflows** (recommended for simplicity)
2. **GitHub Actions workflow** generated by `lol project --automation --write`

See [GitHub Projects v2 Automation](github-workflow.md) for setup details.

## Server Integration

The local server (`lol serve`) polls the viewboard and uses Status + labels to decide what to run:
- Issues with `agentize:plan` and Status = `Plan Accepted` -> spawn implementation worktrees
- Issues with `agentize:plan` + `agentize:refine` and Status = `Proposed` -> run refinement
- PRs with `agentize:pr` and merge conflicts -> trigger rebasing

See [Server](server.md) for the full lifecycle and filters.

## Related

- `github-workflow.md`: GitHub Actions to sync the kanban with the progress of plans and implementations.
- `../commands/setup-viewboard.md`: End-to-end viewboard setup workflow.
- `../architecture/project.md`: Status field configuration and lifecycle details.
- `server.md`: Server automation and polling logic.
